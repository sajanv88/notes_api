const base64_code = "./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split("");
const index_64 = new Uint8Array([
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    0,
    1,
    54,
    55,
    56,
    57,
    58,
    59,
    60,
    61,
    62,
    63,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    2,
    3,
    4,
    5,
    6,
    7,
    8,
    9,
    10,
    11,
    12,
    13,
    14,
    15,
    16,
    17,
    18,
    19,
    20,
    21,
    22,
    23,
    24,
    25,
    26,
    27,
    -1,
    -1,
    -1,
    -1,
    -1,
    -1,
    28,
    29,
    30,
    31,
    32,
    33,
    34,
    35,
    36,
    37,
    38,
    39,
    40,
    41,
    42,
    43,
    44,
    45,
    46,
    47,
    48,
    49,
    50,
    51,
    52,
    53,
    -1,
    -1,
    -1,
    -1,
    -1,
]);
export function encode(d, len) {
    let off = 0;
    let rs = [];
    let c1 = 0;
    let c2 = 0;
    while (off < len) {
        c1 = d[off++] & 0xff;
        rs.push(base64_code[(c1 >> 2) & 0x3f]);
        c1 = (c1 & 0x03) << 4;
        if (off >= len) {
            rs.push(base64_code[c1 & 0x3f]);
            break;
        }
        c2 = d[off++] & 0xff;
        c1 |= (c2 >> 4) & 0x0f;
        rs.push(base64_code[c1 & 0x3f]);
        c1 = (c2 & 0x0f) << 2;
        if (off >= len) {
            rs.push(base64_code[c1 & 0x3f]);
            break;
        }
        c2 = d[off++] & 0xff;
        c1 |= (c2 >> 6) & 0x03;
        rs.push(base64_code[c1 & 0x3f]);
        rs.push(base64_code[c2 & 0x3f]);
    }
    return rs.join("");
}
function char64(x) {
    if (x.length > 1) {
        throw new Error("Expected a single character");
    }
    let characterAsciiCode = x.charCodeAt(0);
    if (characterAsciiCode < 0 || characterAsciiCode > index_64.length)
        return -1;
    return index_64[characterAsciiCode];
}
export function decode(s, maxolen) {
    let rs = [];
    let off = 0;
    let slen = s.length;
    let olen = 0;
    let ret;
    let c1, c2, c3, c4, o;
    if (maxolen <= 0)
        throw new Error("Invalid maxolen");
    while (off < slen - 1 && olen < maxolen) {
        c1 = char64(s.charAt(off++));
        c2 = char64(s.charAt(off++));
        if (c1 === -1 || c2 === -1)
            break;
        o = c1 << 2;
        o |= (c2 & 0x30) >> 4;
        rs.push(o);
        if (++olen >= maxolen || off >= slen)
            break;
        c3 = char64(s.charAt(off++));
        if (c3 === -1)
            break;
        o = (c2 & 0x0f) << 4;
        o |= (c3 & 0x3c) >> 2;
        rs.push(o);
        if (++olen >= maxolen || off >= slen)
            break;
        c4 = char64(s.charAt(off++));
        o = (c3 & 0x03) << 6;
        o |= c4;
        rs.push(o);
        ++olen;
    }
    ret = new Uint8Array(olen);
    for (off = 0; off < olen; off++)
        ret[off] = rs[off];
    return ret;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZTY0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYmFzZTY0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sV0FBVyxHQUNmLGtFQUFrRSxDQUFDLEtBQUssQ0FDdEUsRUFBRSxDQUNILENBQUM7QUFFSixNQUFNLFFBQVEsR0FBRyxJQUFJLFVBQVUsQ0FBQztJQUM5QixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDO0lBQ0QsQ0FBQztJQUNELEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDLENBQUM7SUFDRixDQUFDO0lBQ0QsQ0FBQztJQUNELENBQUM7SUFDRCxDQUFDO0lBQ0QsQ0FBQztJQUNELENBQUM7SUFDRCxDQUFDO0lBQ0QsQ0FBQztJQUNELEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLENBQUMsQ0FBQztJQUNGLENBQUMsQ0FBQztJQUNGLENBQUMsQ0FBQztJQUNGLENBQUMsQ0FBQztJQUNGLENBQUMsQ0FBQztJQUNGLENBQUMsQ0FBQztJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsRUFBRTtJQUNGLEVBQUU7SUFDRixFQUFFO0lBQ0YsQ0FBQyxDQUFDO0lBQ0YsQ0FBQyxDQUFDO0lBQ0YsQ0FBQyxDQUFDO0lBQ0YsQ0FBQyxDQUFDO0lBQ0YsQ0FBQyxDQUFDO0NBQ0gsQ0FBQyxD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R0FBRyxJQUFJLEdBQUcsQ0FBQyxJQUFJLElBQUksR0FBRyxPQUFPLEVBQUU7UUFDdkMsRUFBRSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUM3QixFQUFFLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzdCLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFBRSxNQUFNO1FBQ2xDLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ1osQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN0QixFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ1gsSUFBSSxFQUFFLElBQUksSUFBSSxPQUFPLElBQUksR0FBRyxJQUFJLElBQUk7WUFBRSxNQUFNO1FBQzVDLEVBQUUsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDN0IsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQUUsTUFBTTtRQUNyQixDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JCLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEIsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNYLElBQUksRUFBRSxJQUFJLElBQUksT0FBTyxJQUFJLEdBQUcsSUFBSSxJQUFJO1lBQUUsTUFBTTtRQUM1QyxFQUFFLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzdCLENBQUMsR0FBRyxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckIsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUNSLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDWCxFQUFFLElBQUksQ0FBQztLQUNSO0lBRUQsR0FBRyxHQUFHLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzNCLEtBQUssR0FBRyxHQUFHLENBQUMsRUFBRSxHQUFHLEdBQUcsSUFBSSxFQUFFLEdBQUcsRUFBRTtRQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDcEQsT0FBTyxHQUFHLENBQUM7QUFDYixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYmFzZTY0X2NvZGUgPVxuICBcIi4vQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODlcIi5zcGxpdChcbiAgICBcIlwiLFxuICApO1xuXG5jb25zdCBpbmRleF82NCA9IG5ldyBVaW50OEFycmF5KFtcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIDAsXG4gIDEsXG4gIDU0LFxuICA1NSxcbiAgNTYsXG4gIDU3LFxuICA1OCxcbiAgNTksXG4gIDYwLFxuICA2MSxcbiAgNjIsXG4gIDYzLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgMixcbiAgMyxcbiAgNCxcbiAgNSxcbiAgNixcbiAgNyxcbiAgOCxcbiAgOSxcbiAgMTAsXG4gIDExLFxuICAxMixcbiAgMTMsXG4gIDE0LFxuICAxNSxcbiAgMTYsXG4gIDE3LFxuICAxOCxcbiAgMTksXG4gIDIwLFxuICAyMSxcbiAgMjIsXG4gIDIzLFxuICAyNCxcbiAgMjUsXG4gIDI2LFxuICAyNyxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgMjgsXG4gIDI5LFxuICAzMCxcbiAgMzEsXG4gIDMyLFxuICAzMyxcbiAgMzQsXG4gIDM1LFxuICAzNixcbiAgMzcsXG4gIDM4LFxuICAzOSxcbiAgNDAsXG4gIDQxLFxuICA0MixcbiAgNDMsXG4gIDQ0LFxuICA0NSxcbiAgNDYsXG4gIDQ3LFxuICA0OCxcbiAgNDksXG4gIDUwLFxuICA1MSxcbiAgNTIsXG4gIDUzLFxuICAtMSxcbiAgLTEsXG4gIC0xLFxuICAtMSxcbiAgLTEsXG5dKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZShkOiBVaW50OEFycmF5LCBsZW46IG51bWJlcik6IHN0cmluZyB7XG4gIGxldCBvZmYgPSAwO1xuICBsZXQgcnM6IHN0cmluZ1tdID0gW107XG4gIGxldCBjMSA9IDA7XG4gIGxldCBjMiA9IDA7XG5cbiAgd2hpbGUgKG9mZiA8IGxlbikge1xuICAgIGMxID0gZFtvZmYrK10gJiAweGZmO1xuICAgIHJzLnB1c2goYmFzZTY0X2NvZGVbKGMxID4+IDIpICYgMHgzZl0pO1xuICAgIGMxID0gKGMxICYgMHgwMykgPDwgNDtcbiAgICBpZiAob2ZmID49IGxlbikge1xuICAgICAgcnMucHVzaChiYXNlNjRfY29kZVtjMSAmIDB4M2ZdKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjMiA9IGRbb2ZmKytdICYgMHhmZjtcbiAgICBjMSB8PSAoYzIgPj4gNCkgJiAweDBmO1xuICAgIHJzLnB1c2goYmFzZTY0X2NvZGVbYzEgJiAweDNmXSk7XG4gICAgYzEgPSAoYzIgJiAweDBmKSA8PCAyO1xuICAgIGlmIChvZmYgPj0gbGVuKSB7XG4gICAgICBycy5wdXNoKGJhc2U2NF9jb2RlW2MxICYgMHgzZl0pO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGMyID0gZFtvZmYrK10gJiAweGZmO1xuICAgIGMxIHw9IChjMiA+PiA2KSAmIDB4MDM7XG4gICAgcnMucHVzaChiYXNlNjRfY29kZVtjMSAmIDB4M2ZdKTtcbiAgICBycy5wdXNoKGJhc2U2NF9jb2RlW2MyICYgMHgzZl0pO1xuICB9XG4gIHJldHVybiBycy5qb2luKFwiXCIpO1xufVxuXG4vLyB4IGlzIGEgc2luZ2xlIGNoYXJhY3RlclxuZnVuY3Rpb24gY2hhcjY0KHg6IHN0cmluZyk6IG51bWJlciB7XG4gIGlmICh4Lmxlbmd0aCA+IDEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RlZCBhIHNpbmdsZSBjaGFyYWN0ZXJcIik7XG4gIH1cblxuICBsZXQgY2hhcmFjdGVyQXNjaWlDb2RlID0geC5jaGFyQ29kZUF0KDApO1xuXG4gIGlmIChjaGFyYWN0ZXJBc2NpaUNvZGUgPCAwIHx8IGNoYXJhY3RlckFzY2lpQ29kZSA+IGluZGV4XzY0Lmxlbmd0aCkgcmV0dXJuIC0xO1xuICByZXR1cm4gaW5kZXhfNjRbY2hhcmFjdGVyQXNjaWlDb2RlXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZShzOiBzdHJpbmcsIG1heG9sZW46IG51bWJlcik6IFVpbnQ4QXJyYXkge1xuICBsZXQgcnM6IG51bWJlcltdID0gW107XG4gIGxldCBvZmYgPSAwO1xuICBsZXQgc2xlbiA9IHMubGVuZ3RoO1xuICBsZXQgb2xlbiA9IDA7XG4gIGxldCByZXQ6IFVpbnQ4QXJyYXk7XG4gIGxldCBjMSwgYzIsIGMzLCBjNCwgbztcblxuICBpZiAobWF4b2xlbiA8PSAwKSB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIG1heG9sZW5cIik7XG5cbiAgd2hpbGUgKG9mZiA8IHNsZW4gLSAxICYmIG9sZW4gPCBtYXhvbGVuKSB7XG4gICAgYzEgPSBjaGFyNjQocy5jaGFyQXQob2ZmKyspKTtcbiAgICBjMiA9IGNoYXI2NChzLmNoYXJBdChvZmYrKykpO1xuICAgIGlmIChjMSA9PT0gLTEgfHwgYzIgPT09IC0xKSBicmVhaztcbiAgICBvID0gYzEgPDwgMjtcbiAgICBvIHw9IChjMiAmIDB4MzApID4+IDQ7XG4gICAgcnMucHVzaChvKTtcbiAgICBpZiAoKytvbGVuID49IG1heG9sZW4gfHwgb2ZmID49IHNsZW4pIGJyZWFrO1xuICAgIGMzID0gY2hhcjY0KHMuY2hhckF0KG9mZisrKSk7XG4gICAgaWYgKGMzID09PSAtMSkgYnJlYWs7XG4gICAgbyA9IChjMiAmIDB4MGYpIDw8IDQ7XG4gICAgbyB8PSAoYzMgJiAweDNjKSA+PiAyO1xuICAgIHJzLnB1c2gobyk7XG4gICAgaWYgKCsrb2xlbiA+PSBtYXhvbGVuIHx8IG9mZiA+PSBzbGVuKSBicmVhaztcbiAgICBjNCA9IGNoYXI2NChzLmNoYXJBdChvZmYrKykpO1xuICAgIG8gPSAoYzMgJiAweDAzKSA8PCA2O1xuICAgIG8gfD0gYzQ7XG4gICAgcnMucHVzaChvKTtcbiAgICArK29sZW47XG4gIH1cblxuICByZXQgPSBuZXcgVWludDhBcnJheShvbGVuKTtcbiAgZm9yIChvZmYgPSAwOyBvZmYgPCBvbGVuOyBvZmYrKykgcmV0W29mZl0gPSByc1tvZmZdO1xuICByZXR1cm4gcmV0O1xufVxuIl19